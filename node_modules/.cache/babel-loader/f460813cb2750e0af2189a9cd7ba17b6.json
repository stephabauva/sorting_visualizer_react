{"ast":null,"code":"var c = document.getElementById(\"c\");\nvar ctx = c.getContext(\"2d\");\nvar cH;\nvar cW;\nvar bgColor = \"#FF6138\";\nvar animations = [];\nvar circles = [];\n\nvar colorPicker = function () {\n  var colors = [\"#FF6138\", \"#FFBE53\", \"#2980B9\", \"#282741\"];\n  var index = 0;\n\n  function next() {\n    index = index++ < colors.length - 1 ? index : 0;\n    return colors[index];\n  }\n\n  function current() {\n    return colors[index];\n  }\n\n  return {\n    next: next,\n    current: current\n  };\n}();\n\nfunction removeAnimation(animation) {\n  var index = animations.indexOf(animation);\n  if (index > -1) animations.splice(index, 1);\n}\n\nfunction calcPageFillRadius(x, y) {\n  var l = Math.max(x - 0, cW - x);\n  var h = Math.max(y - 0, cH - y);\n  return Math.sqrt(Math.pow(l, 2) + Math.pow(h, 2));\n}\n\nfunction addClickListeners() {\n  document.addEventListener(\"touchstart\", handleEvent);\n  document.addEventListener(\"mousedown\", handleEvent);\n}\n\n;\n\nfunction handleEvent(e) {\n  if (e.touches) {\n    e.preventDefault();\n    e = e.touches[0];\n  }\n\n  var currentColor = colorPicker.current();\n  var nextColor = colorPicker.next();\n  var targetR = calcPageFillRadius(e.pageX, e.pageY);\n  var rippleSize = Math.min(200, cW * .4);\n  var minCoverDuration = 750;\n  var pageFill = new Circle({\n    x: e.pageX,\n    y: e.pageY,\n    r: 0,\n    fill: nextColor\n  });\n  var fillAnimation = anime({\n    targets: pageFill,\n    r: targetR,\n    duration: Math.max(targetR / 2, minCoverDuration),\n    easing: \"easeOutQuart\",\n    complete: function () {\n      bgColor = pageFill.fill;\n      removeAnimation(fillAnimation);\n    }\n  });\n  var ripple = new Circle({\n    x: e.pageX,\n    y: e.pageY,\n    r: 0,\n    fill: currentColor,\n    stroke: {\n      width: 3,\n      color: currentColor\n    },\n    opacity: 1\n  });\n  var rippleAnimation = anime({\n    targets: ripple,\n    r: rippleSize,\n    opacity: 0,\n    easing: \"easeOutExpo\",\n    duration: 900,\n    complete: removeAnimation\n  });\n  var particles = [];\n\n  for (var i = 0; i < 32; i++) {\n    var particle = new Circle({\n      x: e.pageX,\n      y: e.pageY,\n      fill: currentColor,\n      r: anime.random(24, 48)\n    });\n    particles.push(particle);\n  }\n\n  var particlesAnimation = anime({\n    targets: particles,\n    x: function (particle) {\n      return particle.x + anime.random(rippleSize, -rippleSize);\n    },\n    y: function (particle) {\n      return particle.y + anime.random(rippleSize * 1.15, -rippleSize * 1.15);\n    },\n    r: 0,\n    easing: \"easeOutExpo\",\n    duration: anime.random(1000, 1300),\n    complete: removeAnimation\n  });\n  animations.push(fillAnimation, rippleAnimation, particlesAnimation);\n}\n\nfunction extend(a, b) {\n  for (var key in b) {\n    if (b.hasOwnProperty(key)) {\n      a[key] = b[key];\n    }\n  }\n\n  return a;\n}\n\nvar Circle = function (opts) {\n  extend(this, opts);\n};\n\n_c = Circle;\n\nCircle.prototype.draw = function () {\n  ctx.globalAlpha = this.opacity || 1;\n  ctx.beginPath();\n  ctx.arc(this.x, this.y, this.r, 0, 2 * Math.PI, false);\n\n  if (this.stroke) {\n    ctx.strokeStyle = this.stroke.color;\n    ctx.lineWidth = this.stroke.width;\n    ctx.stroke();\n  }\n\n  if (this.fill) {\n    ctx.fillStyle = this.fill;\n    ctx.fill();\n  }\n\n  ctx.closePath();\n  ctx.globalAlpha = 1;\n};\n\nvar animate = anime({\n  duration: Infinity,\n  update: function () {\n    ctx.fillStyle = bgColor;\n    ctx.fillRect(0, 0, cW, cH);\n    animations.forEach(function (anim) {\n      anim.animatables.forEach(function (animatable) {\n        animatable.target.draw();\n      });\n    });\n  }\n});\n\nvar resizeCanvas = function () {\n  cW = window.innerWidth;\n  cH = window.innerHeight;\n  c.width = cW * devicePixelRatio;\n  c.height = cH * devicePixelRatio;\n  ctx.scale(devicePixelRatio, devicePixelRatio);\n};\n\n(function init() {\n  resizeCanvas();\n\n  if (window.CP) {\n    // CodePen's loop detection was causin' problems\n    // and I have no idea why, so...\n    window.CP.PenTimer.MAX_TIME_IN_LOOP_WO_EXIT = 6000;\n  }\n\n  window.addEventListener(\"resize\", resizeCanvas);\n  addClickListeners();\n\n  if (!!window.location.pathname.match(/fullcpgrid/)) {\n    startFauxClicking();\n  }\n\n  handleInactiveUser();\n})();\n\nfunction handleInactiveUser() {\n  var inactive = setTimeout(function () {\n    fauxClick(cW / 2, cH / 2);\n  }, 2000);\n\n  function clearInactiveTimeout() {\n    clearTimeout(inactive);\n    document.removeEventListener(\"mousedown\", clearInactiveTimeout);\n    document.removeEventListener(\"touchstart\", clearInactiveTimeout);\n  }\n\n  document.addEventListener(\"mousedown\", clearInactiveTimeout);\n  document.addEventListener(\"touchstart\", clearInactiveTimeout);\n}\n\nfunction startFauxClicking() {\n  setTimeout(function () {\n    fauxClick(anime.random(cW * .2, cW * .8), anime.random(cH * .2, cH * .8));\n    startFauxClicking();\n  }, anime.random(200, 900));\n}\n\nfunction fauxClick(x, y) {\n  var fauxClick = new Event(\"mousedown\");\n  fauxClick.pageX = x;\n  fauxClick.pageY = y;\n  document.dispatchEvent(fauxClick);\n}\n\nvar _c;\n\n$RefreshReg$(_c, \"Circle\");","map":{"version":3,"sources":["/Users/urdoom/sorting_visualizer_react/src/sortingVisualizer/ExplosiveClic.js"],"names":["c","document","getElementById","ctx","getContext","cH","cW","bgColor","animations","circles","colorPicker","colors","index","next","length","current","removeAnimation","animation","indexOf","splice","calcPageFillRadius","x","y","l","Math","max","h","sqrt","pow","addClickListeners","addEventListener","handleEvent","e","touches","preventDefault","currentColor","nextColor","targetR","pageX","pageY","rippleSize","min","minCoverDuration","pageFill","Circle","r","fill","fillAnimation","anime","targets","duration","easing","complete","ripple","stroke","width","color","opacity","rippleAnimation","particles","i","particle","random","push","particlesAnimation","extend","a","b","key","hasOwnProperty","opts","prototype","draw","globalAlpha","beginPath","arc","PI","strokeStyle","lineWidth","fillStyle","closePath","animate","Infinity","update","fillRect","forEach","anim","animatables","animatable","target","resizeCanvas","window","innerWidth","innerHeight","devicePixelRatio","height","scale","init","CP","PenTimer","MAX_TIME_IN_LOOP_WO_EXIT","location","pathname","match","startFauxClicking","handleInactiveUser","inactive","setTimeout","fauxClick","clearInactiveTimeout","clearTimeout","removeEventListener","Event","dispatchEvent"],"mappings":"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","sourcesContent":["var c = document.getElementById(\"c\");\nvar ctx = c.getContext(\"2d\");\nvar cH;\nvar cW;\nvar bgColor = \"#FF6138\";\nvar animations = [];\nvar circles = [];\n\nvar colorPicker = (function() {\n  var colors = [\"#FF6138\", \"#FFBE53\", \"#2980B9\", \"#282741\"];\n  var index = 0;\n  function next() {\n    index = index++ < colors.length-1 ? index : 0;\n    return colors[index];\n  }\n  function current() {\n    return colors[index]\n  }\n  return {\n    next: next,\n    current: current\n  }\n})();\n\nfunction removeAnimation(animation) {\n  var index = animations.indexOf(animation);\n  if (index > -1) animations.splice(index, 1);\n}\n\nfunction calcPageFillRadius(x, y) {\n  var l = Math.max(x - 0, cW - x);\n  var h = Math.max(y - 0, cH - y);\n  return Math.sqrt(Math.pow(l, 2) + Math.pow(h, 2));\n}\n\nfunction addClickListeners() {\n  document.addEventListener(\"touchstart\", handleEvent);\n  document.addEventListener(\"mousedown\", handleEvent);\n};\n\nfunction handleEvent(e) {\n    if (e.touches) { \n      e.preventDefault();\n      e = e.touches[0];\n    }\n    var currentColor = colorPicker.current();\n    var nextColor = colorPicker.next();\n    var targetR = calcPageFillRadius(e.pageX, e.pageY);\n    var rippleSize = Math.min(200, (cW * .4));\n    var minCoverDuration = 750;\n    \n    var pageFill = new Circle({\n      x: e.pageX,\n      y: e.pageY,\n      r: 0,\n      fill: nextColor\n    });\n    var fillAnimation = anime({\n      targets: pageFill,\n      r: targetR,\n      duration:  Math.max(targetR / 2 , minCoverDuration ),\n      easing: \"easeOutQuart\",\n      complete: function(){\n        bgColor = pageFill.fill;\n        removeAnimation(fillAnimation);\n      }\n    });\n    \n    var ripple = new Circle({\n      x: e.pageX,\n      y: e.pageY,\n      r: 0,\n      fill: currentColor,\n      stroke: {\n        width: 3,\n        color: currentColor\n      },\n      opacity: 1\n    });\n    var rippleAnimation = anime({\n      targets: ripple,\n      r: rippleSize,\n      opacity: 0,\n      easing: \"easeOutExpo\",\n      duration: 900,\n      complete: removeAnimation\n    });\n    \n    var particles = [];\n    for (var i=0; i<32; i++) {\n      var particle = new Circle({\n        x: e.pageX,\n        y: e.pageY,\n        fill: currentColor,\n        r: anime.random(24, 48)\n      })\n      particles.push(particle);\n    }\n    var particlesAnimation = anime({\n      targets: particles,\n      x: function(particle){\n        return particle.x + anime.random(rippleSize, -rippleSize);\n      },\n      y: function(particle){\n        return particle.y + anime.random(rippleSize * 1.15, -rippleSize * 1.15);\n      },\n      r: 0,\n      easing: \"easeOutExpo\",\n      duration: anime.random(1000,1300),\n      complete: removeAnimation\n    });\n    animations.push(fillAnimation, rippleAnimation, particlesAnimation);\n}\n\nfunction extend(a, b){\n  for(var key in b) {\n    if(b.hasOwnProperty(key)) {\n      a[key] = b[key];\n    }\n  }\n  return a;\n}\n\nvar Circle = function(opts) {\n  extend(this, opts);\n}\n\nCircle.prototype.draw = function() {\n  ctx.globalAlpha = this.opacity || 1;\n  ctx.beginPath();\n  ctx.arc(this.x, this.y, this.r, 0, 2 * Math.PI, false);\n  if (this.stroke) {\n    ctx.strokeStyle = this.stroke.color;\n    ctx.lineWidth = this.stroke.width;\n    ctx.stroke();\n  }\n  if (this.fill) {\n    ctx.fillStyle = this.fill;\n    ctx.fill();\n  }\n  ctx.closePath();\n  ctx.globalAlpha = 1;\n}\n\nvar animate = anime({\n  duration: Infinity,\n  update: function() {\n    ctx.fillStyle = bgColor;\n    ctx.fillRect(0, 0, cW, cH);\n    animations.forEach(function(anim) {\n      anim.animatables.forEach(function(animatable) {\n        animatable.target.draw();\n      });\n    });\n  }\n});\n\nvar resizeCanvas = function() {\n  cW = window.innerWidth;\n  cH = window.innerHeight;\n  c.width = cW * devicePixelRatio;\n  c.height = cH * devicePixelRatio;\n  ctx.scale(devicePixelRatio, devicePixelRatio);\n};\n\n(function init() {\n  resizeCanvas();\n  if (window.CP) {\n    // CodePen's loop detection was causin' problems\n    // and I have no idea why, so...\n    window.CP.PenTimer.MAX_TIME_IN_LOOP_WO_EXIT = 6000; \n  }\n  window.addEventListener(\"resize\", resizeCanvas);\n  addClickListeners();\n  if (!!window.location.pathname.match(/fullcpgrid/)) {\n    startFauxClicking();\n  }\n  handleInactiveUser();\n})();\n\nfunction handleInactiveUser() {\n  var inactive = setTimeout(function(){\n    fauxClick(cW/2, cH/2);\n  }, 2000);\n  \n  function clearInactiveTimeout() {\n    clearTimeout(inactive);\n    document.removeEventListener(\"mousedown\", clearInactiveTimeout);\n    document.removeEventListener(\"touchstart\", clearInactiveTimeout);\n  }\n  \n  document.addEventListener(\"mousedown\", clearInactiveTimeout);\n  document.addEventListener(\"touchstart\", clearInactiveTimeout);\n}\n\nfunction startFauxClicking() {\n  setTimeout(function(){\n    fauxClick(anime.random( cW * .2, cW * .8), anime.random(cH * .2, cH * .8));\n    startFauxClicking();\n  }, anime.random(200, 900));\n}\n\nfunction fauxClick(x, y) {\n  var fauxClick = new Event(\"mousedown\");\n  fauxClick.pageX = x;\n  fauxClick.pageY = y;\n  document.dispatchEvent(fauxClick);\n}\n"]},"metadata":{},"sourceType":"module"}